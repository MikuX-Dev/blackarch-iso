container:
  image: mikuxdev/archiso-builder:latest
  options: --privileged
  cpu: 6
  memory: 16G

task:
  name: Build and Push Arch ISO Docker Image
  env:
    GITHUB_TOKEN: ENCRYPTED[dbdc270de8848b06fb63e17ed7723609661a3eea836bdd15712700d7ab1ed5db60a8574a50130e3c435683c143354f9c]
  checkout_script:
    - git clone https://github.com/MikuX-Dev/blackarch-iso
    - mkdir -p work out
  install_script:
    - pacman -Syy
  build_script:
    - mkarchiso -v -r -w work -o out blackarch-iso/slim-iso
  upload_artifacts_script:
    - cirrus upload out/*.iso --name "Blackarch-slim-iso"
